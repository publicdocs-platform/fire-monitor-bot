- const friendlyDate = (d) => new Date(d).toLocaleString('en-US', {timeZone:'UTC', hour12:true, year: 'numeric', day: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric', timeZoneName: 'short'});
- const mapData = Object.assign({}, {cities: data.cities ? data.cities.all : []}, data.mapData || {});
doctype html
html.perim
    head
        meta(charset="UTF-8")
        link(rel="stylesheet",href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/css/ol.css",integrity="sha384-C7SzZySesoxngSK5V0BaD1DUap0LPZGWZpnXQGoIwvBXFc8G21y4s1QYvyr84FNa",crossorigin="anonymous")

        script(src='https://code.jquery.com/jquery-3.3.1.min.js',
               integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=",crossorigin="anonymous")

        script(src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js",
               integrity="sha384-yaIgZleEnDCw26CwitrCKE9Jl4wLWEBw7moR6IF7CXoeMpRVWmOc0NDk222RUhBU",
               crossorigin="anonymous")

        script
            include ../node_modules/ol-helpers/index.js
        script
            include ../client/renderMap.js
        style
            include style.css

            
    body
        div.content
            div.warn
                div.warn-icon
                    include ../imgs/warning.svg
                div.warn-content(style='padding-top:20px;')
                    | DO NOT USE FOR HEALTH, SAFETY, EMERGENCY, or EVACUATION PURPOSES. Consult local public officials for health, safety, emergency, or evacuation info.
                    br
                    | Unofficial report. For information only. Automated fire information is APPROXIMATE and often INCORRECT and OUT-OF-DATE.
                    br
                    | USE AT YOUR OWN RISK â€” FIRES MAY BE CLOSER AND LARGER THAN THEY APPEAR HERE
            div.warn
                if (data.current ? (data.current.NFSAType || '') : '').includes('Emerging')
                    div.innerWarn
                        | This is an emerging fire report - details may be especially uncertain.
                div.cite
                    b 
                        | To the maximum extent permitted by law: (1) all content is provided to you on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, WHETHER EXPRESS, IMPLIED, STATUTORY, OR OTHER (INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDNTIONS OF TITLE, MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NONINFRINGEMENT); and (2) IN NO EVENT WILL ANY AUTHOR OR DATA PROVIDER BE LIABLE TO YOU ON ANY LEGAL THEORY (INCLUDING, WITHOUT LIMITATION, NEGLIGENCE) OR OTHERWISE FOR ANY DIRECT, SPECIAL, INDIRECT, INCIDENTAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY, OR OTHER LOSSES, COSTS, EXPENSES, OR DAMAGES arising out of your use of this content, even if the author or data provider has been advised of the possibility of such losses, costs, expenses, or damages.
                    br
                    | Generated by twitter.com/@#{config.twitterName} using #{config.systemName}.
                    | Not affiliated with or endorsed by any government agencies.
                    br
                    | No claim to original U.S. Government works. Source data may be modified or combined with other data.
                    | Open original image for full resolution. EPSG:3857.
            div#map(class='map bigMap',style='position:relative;')
                div.mapTitle
                    h1
                        if data.current
                            span #{data.current.Fire_Name} Fire
                        else
                            span #{data.title}
                        if data.perimDateTime
                            span.perimDate Perimeter @#{friendlyDate(data.perimDateTime)} (entire fire is not shown here)
                        else
                            span.perimDate General Vicinity (entire fire is not shown here)
                        each st in (data.subtitle || [])
                            .detailSubtitle
                                | #{st}
        script
            | showMap(#{data.lon}, #{data.lat}, #{data.zoom}, 'perim', !{JSON.stringify(mapData)});

        
